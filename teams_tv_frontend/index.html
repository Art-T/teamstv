<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>COE TV</title>

  <script src="./node_modules/angular/angular.min.js"></script>
  <script src="./jquery/jquery-3.3.1.min.js" type="text/javascript"></script>
  <script src="./dsmorse-gridster.js-2808cd7/dist/jquery.gridster.js" type="text/javascript"></script>
  <script src="app.js"></script>

  <link rel="stylesheet" type="text/css" href="./dsmorse-gridster.js-2808cd7/dist/jquery.gridster.min.css">

  <link rel="stylesheet" type="text/css" href="./gridster_custom.css">

  <meta http-equiv="refresh" content="30">

</head>
<body ng-app="COETVApp">
  	<div ng-controller="COETVAppController">
  		<div class="gridster ready">
		    <ul>
		    </ul>
		</div>
	</div>

	<script type="text/javascript">

    var gridster;

    var serialization = [];

    // for grid testing
    // for (var h = 1; h < 7; h++) {
    // 	for (var v = 1; v < 7; v++) {
    // 		serialization.push({
    // 			col: h, row: v, size_x: 1, size_y: 1
    // 		})
    // 	}
    // }

    $(function () {

        gridster = $(".gridster ul").gridster({
            widget_base_dimensions: [320, 180],
            widget_margins: [0, 0]
        }).data('gridster');

        function buildGrid(elements) {
          gridster.remove_all_widgets();

          elements = Gridster.sort_by_row_and_col_asc(elements);

          $.each(elements, function (i, element) {
            gridster.add_widget('<li>'+element.html+'</li>', element.size_x, element.size_y, element.col, element.row);
          });

          document.getElementById("resolution").innerHTML = window.screen.width + " x " + window.screen.height;
        }

        $.getJSON( "data.json", function( data ) {
          $.each(data.blocks, function (i, block) {
            serialization.push({
              col: block.position[0], row: block.position[1], size_x: block.size[0], size_y: block.size[1], html: block.html
            });
          });
          buildGrid(serialization);        
        });
    });

	</script>
</body>
</html>